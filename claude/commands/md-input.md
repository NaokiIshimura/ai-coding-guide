---
allowed-tools: Read, Glob, Bash(ls:*), Bash(find:*), Task
description: 指定したディレクトリ内のmarkdownファイルを読み込んで作業状況を把握する
---

## コンテキスト

- 現在のディレクトリ: !`pwd`
- 現在のブランチ: !`git branch --show-current`

## タスク

指定されたディレクトリ内のmarkdownファイルをすべて読み込み、過去の作業状況や調査結果を把握してください。

### 実施手順

1. **読み込み対象ディレクトリの決定**
   - 引数が指定されている場合はそのパスを使用
   - 引数がない場合はデフォルト: `claude/outputs/`

2. **markdownファイルの検索と読み込み**
   - 指定されたディレクトリ内のすべてのmarkdownファイル(.md)を検索
   - ファイルのタイムスタンプ順（新しい順）にソート
   - **すべてのファイルを読み込む**（ファイル数に関わらず）

3. **ファイル数に応じた処理の最適化**
   - ファイル数が10件以下の場合：
     - すべてのファイルを直接読み込んで分析
   - ファイル数が10件を超える場合：
     - `file-collector` エージェントを使用してメインタスクのコンテキストを節約
     - エージェントが収集した情報を統合

4. **ファイル内容の読み込みと分析**
   - すべてのmarkdownファイルを順次読み込み
   - 各ファイルの主要な情報を抽出：
     - タイトルと概要
     - 実施日時
     - 作業内容/調査結果の要約
     - 発見事項・課題
     - 次のステップ
   - ファイル間の関連性や時系列での変化を分析

5. **情報の統合と要約**
   以下の形式で情報を整理：

   ```markdown
   # 過去の作業状況サマリー

   ## 読み込んだファイル一覧
   1. [ファイル名] - [日時] - [トピック]
   2. ...

   ## 時系列での作業履歴
   ### [日付1]
   - 実施した作業
   - 主要な成果
   - 発見した課題

   ### [日付2]
   - ...

   ## 主要なトピック別整理
   ### [トピック1]
   - 関連する作業内容
   - 進捗状況
   - 残課題

   ### [トピック2]
   - ...

   ## 未解決の課題・継続タスク
   - 課題1: 詳細と優先度
   - 課題2: ...

   ## 次に取り組むべき項目
   1. 優先度の高い項目
   2. ...

   ## 参考情報
   - 読み込んだファイルへのパス
   - 関連するコード変更
   ```

6. **サマリーの提示**
   - 統合された情報をユーザーに提示
   - 必要に応じて詳細情報へのリンクを含める
   - 次のアクションの提案

### ディレクトリ指定方法

コマンド実行時に引数でディレクトリを指定できます：

- 引数なし: `claude/outputs/` (デフォルト)
- 引数あり: 指定されたディレクトリパス

**使用例**:
```bash
# デフォルト（claude/outputs/のすべてのファイルを読み込み）
/markdown-input

# 特定のディレクトリから読み込み
/markdown-input claude/tasks/ABC-123/

# カスタムパスから読み込み
/markdown-input path/to/directory/
```

### 高度な機能

1. **関連性分析**
   - 複数ファイル間の関連性を自動検出
   - 同じトピックや課題についての進捗を追跡
   - 依存関係のあるタスクを識別

2. **進捗トラッキング**
   - 過去の計画と実際の成果を比較
   - 未完了タスクの抽出
   - 繰り返し発生する課題の検出

3. **コンテキスト復元**
   - 過去の作業状況から現在のコンテキストを復元
   - 中断していた作業の再開をサポート
   - 過去の判断理由や背景情報の提供

4. **sub-agent連携**
   - 大量のファイルがある場合は `file-collector` エージェントを使用
   - ファイル数が10件を超える場合は自動的にsub-agentを起動

### 注意事項

- **すべて読み込み**: 指定ディレクトリ内のすべてのmarkdownファイルを読み込みます
- **大量ファイル**: 10件以上のファイルがある場合はsub-agentを使用してメインタスクのコンテキストを節約
- **ファイル形式**: markdownファイル(.md)のみを対象
- **エンコーディング**: UTF-8を前提
- **破損ファイル**: 読み込みエラーが発生した場合はスキップして次のファイルへ
- **メモリ効率**: 大きなファイルは要約情報のみを抽出
- **プライバシー**: 機密情報が含まれる可能性があるファイルは慎重に扱う

### 期待される成果

1. 過去の作業履歴が明確に把握できる
2. 中断していた作業を円滑に再開できる
3. 未解決の課題や継続タスクが可視化される
4. 時系列での進捗や変化が理解できる
5. 次に取り組むべき項目が明確になる
