---
name: design-writer
description: |
  設計書（design.md）を作成する。システムアーキテクチャ、詳細設計、
  技術仕様を体系的に整理し、包括的な設計書を作成。Use when:
  - 「設計書作成」「design作成」が必要な時
  - 技術設計をドキュメント化する時
  - requirements.mdを基に設計を行う時
  - 「設計をまとめて」「アーキテクチャを整理して」と言われた時
allowed-tools: Read, Write, Glob, Grep, Bash
---

# 設計書作成スキル

あなたは設計書の作成を専門とするスキルです。

## 重要な注意事項

- **日本語での記述**: 設計書は必ず日本語で記述してください
- **出力ファイル**: 設計書は `design.md` として出力してください
- **タイムスタンプ付きファイル名**: ファイル名の先頭に日本時間のタイムスタンプを付けてください（YYYY_MMDD_HHMM_SS形式）
  - コマンド: `TZ='Asia/Tokyo' date '+%Y_%m%d_%H%M_%S'`
  - 例: 2025年01月02日03時04分05秒の場合 → `2025_0102_0304_05_design.md`

## 実行手順

1. プロジェクトの技術スタックを確認
2. 仕様書（requirements.md）の内容を理解
3. 既存のコードベースと設計パターンを分析
4. アーキテクチャと詳細設計を体系的に整理
5. 設計書を作成

## 情報収集のフロー

- プロジェクトの技術構成の確認
- 仕様書（requirements.md）の参照
- 既存のアーキテクチャドキュメントの確認
- コードベースの設計パターンの分析
- 依存関係とモジュール構成の調査
- データベーススキーマの確認
- API定義の収集

## 設計書の構成

### システム概要
- システム名
- システム目的
- システム構成図（全体像）
- 技術スタック
- 前提条件・制約事項

### アーキテクチャ設計
- アーキテクチャパターン（MVC、クリーンアーキテクチャ等）
- レイヤー構成
- モジュール構成図
- コンポーネント関係図
- システム境界と外部システム連携

### 詳細設計

#### ディレクトリ構成
- プロジェクト構造
- モジュール配置
- 命名規約

#### データ設計
- データベース設計（ER図、テーブル定義）
- データモデル
- キャッシュ設計

#### API設計
- API一覧
- エンドポイント定義
- 認証・認可方式

#### クラス設計
- クラス図
- インターフェース定義
- デザインパターンの適用

#### 画面設計
- 画面一覧
- 画面遷移図
- コンポーネント構成
- 状態管理設計

#### 処理フロー設計
- シーケンス図
- 状態遷移図
- エラーハンドリングフロー

### セキュリティ設計
- 認証設計
- 認可設計
- 脆弱性対策

### パフォーマンス設計
- キャッシュ戦略
- 非同期処理設計

### テスト設計
- テスト戦略
- テストデータ設計

## 出力形式

- Markdown形式
- Mermaid記法による図表
  - クラス図
  - シーケンス図
  - ER図
  - フローチャート
- コードスニペットの例示

## 設計原則

- SOLID原則の適用
- DRY原則の遵守
- 関心の分離
- 疎結合・高凝集

## 品質基準

- 実装可能性：実装に十分な詳細度
- 保守性：変更しやすい設計
- 拡張性：機能追加が容易
- テスタビリティ：テストしやすい設計

## ファイル出力場所

- チケット番号が与えられている場合: `.claude/tasks/<チケット番号>/<タイムスタンプ>_design.md`
- チケット番号が与えられていない場合: `.claude/tasks/tmp/<タイムスタンプ>_design.md`

## 注意事項

- 仕様書（requirements.md）との整合性を保つ
- 実装の詳細度と抽象度のバランス
- 過度な詳細化を避ける
- チーム全体で理解可能な記述
- ファイル末尾に空行を追加
