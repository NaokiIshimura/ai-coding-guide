---
name: spec-writer
description: |
  仕様書（requirements/design/tasks.md）を作成する。3つのドキュメントを統合的に作成。Use when:
  - 「仕様書作成」「spec作成」が必要な時
  - 実装前にドキュメントを揃える時
  - JIRAチケットやissueから仕様書を作成する時
  - 「specを作って」「仕様をまとめて」と言われた時
allowed-tools: Read, Write, Glob, Grep, Bash
---

# 仕様書作成スキル

## 重要な注意事項

- **実装開始前に必ず仕様書を作成すること**
- requirements.md → design.md → tasks.md の順序で作成する
- 各ドキュメントは前のドキュメントの内容を踏まえて作成する
- 不明点がある場合は、ユーザーに確認してから進める
- ファイル名にはタイムスタンプを付与する（日本時間）

## 実行手順

### Step 1: 要件定義書（requirements.md）の作成

1. **情報収集**
   - JIRAチケット、GitHub Issue、ユーザー要求から要件を抽出
   - 既存の関連ドキュメントを確認
   - 不明点はユーザーに確認

2. **要件の整理**
   - 機能要件と非機能要件を分類
   - ユースケースを洗い出し
   - 受け入れ基準を定義

3. **ファイル出力**
   - タイムスタンプ付きでrequirements.mdを出力

### Step 2: 設計書（design.md）の作成

1. **requirements.mdの確認**
   - 要件定義書の内容を踏まえて設計を行う

2. **技術設計**
   - システムアーキテクチャを決定
   - 技術選定と理由を記載
   - データモデル、API仕様を定義

3. **ファイル出力**
   - タイムスタンプ付きでdesign.mdを出力

### Step 3: タスクリスト（tasks.md）の作成

1. **design.mdの確認**
   - 設計書の内容を踏まえてタスクを分解

2. **タスク分解**
   - 実装タスクを洗い出し
   - 優先順位と依存関係を整理
   - 推定工数を設定

3. **ファイル出力**
   - タイムスタンプ付きでtasks.mdを出力

## 情報収集のフロー

```
1. チケット/Issue情報の取得
   ├─ JIRAチケット → atlassian-v2 MCP使用
   ├─ GitHub Issue → github MCP使用
   └─ ユーザー要求 → 対話で確認

2. 既存コードの調査
   ├─ 関連ファイルの特定 → Glob, Grep使用
   ├─ 既存実装パターンの確認 → Read使用
   └─ 依存関係の確認 → package.json, etc.

3. 不明点の確認
   └─ ユーザーへの質問 → 明確化してから進める
```

## 仕様書の構成

### requirements.md（要件定義書）

```markdown
# 要件定義書

## 概要
- 背景・目的
- スコープ

## 機能要件
- FR-1: 機能要件1
- FR-2: 機能要件2
- ...

## 非機能要件
- NFR-1: パフォーマンス要件
- NFR-2: セキュリティ要件
- ...

## ユースケース
- UC-1: ユースケース1
- UC-2: ユースケース2
- ...

## 受け入れ基準
- [ ] 基準1
- [ ] 基準2
- ...

## 制約事項
- 技術的制約
- ビジネス制約
- ...

## 用語集
- 用語1: 定義
- 用語2: 定義
- ...
```

### design.md（設計書）

```markdown
# 設計書

## 概要
- 設計方針
- 前提条件

## システムアーキテクチャ
- 全体構成図
- コンポーネント構成

## 技術選定
| 技術 | 選定理由 |
|------|----------|
| xxx  | xxx      |

## データモデル
- エンティティ定義
- ER図（必要に応じて）

## API仕様
### エンドポイント一覧
| Method | Path | 説明 |
|--------|------|------|
| GET    | /xxx | xxx  |

### 詳細仕様
- リクエスト/レスポンス形式

## シーケンス図
- 主要フローの図示

## セキュリティ考慮事項
- 認証・認可
- データ保護

## エラーハンドリング
- エラーコード一覧
- エラー時の振る舞い
```

### tasks.md（タスクリスト）

```markdown
# タスクリスト

## 概要
- 実装の概要
- 全体スケジュール

## タスク一覧

### 優先度: 高
- [ ] TASK-1: タスク名
  - 説明: xxx
  - 推定工数: x時間
  - 依存: なし

- [ ] TASK-2: タスク名
  - 説明: xxx
  - 推定工数: x時間
  - 依存: TASK-1

### 優先度: 中
- [ ] TASK-3: タスク名
  - 説明: xxx
  - 推定工数: x時間
  - 依存: TASK-2

### 優先度: 低
- [ ] TASK-4: タスク名
  - 説明: xxx
  - 推定工数: x時間
  - 依存: なし

## 依存関係図
```
TASK-1 → TASK-2 → TASK-3
TASK-4（独立）
```

## リスクと対策
| リスク | 対策 |
|--------|------|
| xxx    | xxx  |

## 完了条件
- [ ] 全タスク完了
- [ ] テスト通過
- [ ] レビュー完了
```

## 出力形式

### タイムスタンプ生成コマンド

```bash
TZ='Asia/Tokyo' date '+%Y_%m%d_%H%M_%S'
```

### ファイル名形式

```
YYYY_MMDD_HHMM_SS_requirements.md
YYYY_MMDD_HHMM_SS_design.md
YYYY_MMDD_HHMM_SS_tasks.md
```

### 出力例

```
2026_0119_1430_00_requirements.md
2026_0119_1435_00_design.md
2026_0119_1440_00_tasks.md
```

## 品質基準

### requirements.md
- [ ] 全ての機能要件が明確に記載されている
- [ ] 非機能要件（パフォーマンス、セキュリティ等）が定義されている
- [ ] 受け入れ基準が具体的で検証可能である
- [ ] 用語の定義が統一されている

### design.md
- [ ] アーキテクチャが要件を満たしている
- [ ] 技術選定の理由が明確である
- [ ] データモデルが正規化されている
- [ ] API仕様が完全に定義されている
- [ ] セキュリティが考慮されている

### tasks.md
- [ ] タスクが適切な粒度で分解されている
- [ ] 依存関係が明確である
- [ ] 推定工数が現実的である
- [ ] 優先順位が設定されている
- [ ] 完了条件が明確である

## ファイル出力場所

### チケット番号がある場合

```
.claude/plans/<チケット番号>/YYYY_MMDD_HHMM_SS_requirements.md
.claude/plans/<チケット番号>/YYYY_MMDD_HHMM_SS_design.md
.claude/plans/<チケット番号>/YYYY_MMDD_HHMM_SS_tasks.md
```

### チケット番号がない場合

```
.claude/plans/tmp/YYYY_MMDD_HHMM_SS_requirements.md
.claude/plans/tmp/YYYY_MMDD_HHMM_SS_design.md
.claude/plans/tmp/YYYY_MMDD_HHMM_SS_tasks.md
```

## 注意事項

- **順序を守る**: requirements → design → tasks の順で作成する
- **一貫性**: 3つのドキュメント間で用語・ID等を統一する
- **トレーサビリティ**: 要件→設計→タスクの追跡可能性を確保する
- **更新時**: 既存ファイルがある場合は新しいタイムスタンプで別ファイルとして作成し、履歴を保持する
- **確認**: 不明点がある場合は必ずユーザーに確認してから進める
- **日本語**: 全てのドキュメントは日本語で記述する
- **空行**: ファイル末尾は必ず空行で終わる
